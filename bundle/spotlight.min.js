"use strict";var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Penner=require("penner"),Spotlight=function(){function t(e){_classCallCheck(this,t),this.options=e||{},this.canvas=document.createElement("canvas"),this.options.parent?this.parent.appendChild(this.canvas):document.body.appendChild(this.canvas),this.canvas.style.position="fixed",this.canvas.style.top=this.options.x||0,this.canvas.style.left=this.options.y||0,this.canvas.style.pointerEvents="none",this.openings=[],this.resize()}return _createClass(t,[{key:"resize",value:function(){var t=this.options.width||window.innerWidth,e=this.options.height||window.innerHeight;this.canvas.width=t,this.canvas.height=e,this.redraw()}},{key:"redraw",value:function(){var t=this.canvas.getContext("2d");t.save(),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle=this.options.color||"black",t.globalAlpha=this.options.alpha||.5,t.fillRect(0,0,this.canvas.width,this.canvas.height),t.restore(),t.save(),t.globalCompositeOperation="destination-out";var e=!0,n=!1,i=void 0;try{for(var a,s=this.openings[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var o=a.value;switch(o.type){case"circle":t.beginPath(),t.arc(o.x,o.y,o.radius,0,2*Math.PI),t.fill();break;case"polygon":t.beginPath(),t.moveTo(o.points[0],o.points[1]);for(var r=2;r<o.points.length;r+=2)t.lineTo(o.points[r],o.points[r+1]);t.closePath(),t.fill(),t.stroke()}}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}t.restore()}},{key:"clear",value:function(t){this.openings=[],t||this.resize()}},{key:"circle",value:function(t,e,n,i){this.openings.push({type:"circle",x:t,y:e,radius:n}),i||this.redraw()}},{key:"polygon",value:function(t,e){this.openings.push({type:"polygon",points:t}),e||this.redraw()}},{key:"fade",value:function(t){var e=this;this.request=null;var n=performance.now(),i=n-this.last;this.last=n,t.time+=i,t.time>t.duration?this.canvas.style.opacity=t.end:(this.canvas.style.opacity=t.ease(t.time,t.start,t.end,t.duration),this.request=requestAnimationFrame(function(){return e.fade(t)}))}},{key:"fadeIn",value:function(t){this.request&&cancelAnimationFrame(this.request);var e=(t=t||{}).start||0,n=t.end||1,i=t.ease?"string"==typeof t.ease?Penner[t.ease]:t.ease:Penner.easeInOutSine;this.canvas.style.opacity=e;var a=t.duration||1e3;this.last=performance.now(),this.fade({time:0,start:e,end:n,duration:a,ease:i})}},{key:"fadeOut",value:function(t){(t=t||{}).start=void 0===t.start?1:t.start,t.end=void 0===t.end?0:t.end,this.fadeIn(t)}}]),t}();module.exports=Spotlight;